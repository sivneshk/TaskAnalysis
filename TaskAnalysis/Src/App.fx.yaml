App As appinfo:
    BackEnabled: =false
    OnStart: |-
        =Set(iterator, 0);
        Clear(colTaxonomy);
        Clear(colTaxonomyTemp);
        Clear(FinalTaxonomy);
        
        ClearCollect(
            PrepCollection,
            ForAll(
                Table(ParseJSON(Task_A_PreparerHours.Run("ahmedelsaidmohamed.baioumy@bakerhughes.com").json).body),
                {
                    Email: Text(Value.Email),
                    Coco: Text(Value.Coco),
                    PrepHours: Text(Value.PrepHours)
                }
            )
        );
        
        ClearCollect(
            AppCollection,
            ForAll(
                Table(ParseJSON(Task_A_ApproverHours.Run("bassem.abdelrahman@bakerhughes.com").json).body),
                {
                    Email: Text(Value.Email),
                    Coco: Text(Value.Coco),
                    AppHours: Text(Value.AppHours)
                }
            )
        );
        
        ClearCollect(colGrpByName, GroupBy('Task Analysis Taxonomy Collection', "UserName", "GroupByName"))
    StartScreen: =Switch(Param("ScreenName"), "MainPage", TaskAnalysisScreen, "asManager", 'ForManagerEditScreen/UserHomeScreen')
    Theme: =PowerAppsTheme

    Host As hostControl.DefaultHostControlVariant:
        OnCancel: =false
        OnEdit: =false
        OnNew: =false
        OnSave: =false
        OnView: =false

